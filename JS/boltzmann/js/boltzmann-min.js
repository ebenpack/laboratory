var A=A||{},F={l:200,k:80},G=document.getElementById("boltzmann"),H=F.l,A={l:H,k:F.k,v:[],A:[],M:0.02,J:1/0.56,o:0,j:!1,q:!0,p:[],u:0,e:null,F:G,V:document.getElementById("vectorcanvas"),T:document.getElementById("particlecanvas"),P:document.getElementById("barriercanvas"),G:null,C:null,w:null,D:null,B:10,K:Math.floor(G.width/H)};
(function(){for(var a=0,r=["webkit","moz"],q=0;q<r.length&&!window.requestAnimationFrame;++q)window.requestAnimationFrame=window[r[q]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[q]+"CancelAnimationFrame"]||window[r[q]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(D){var y=(new Date).getTime(),m=Math.max(0,16-(y-a)),h=window.setTimeout(function(){D(y+m)},m);a=y+m;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();A=A||{};
A=function(a){a.f=function(){function r(b,a){function c(b,a,d){0>d&&(d+=1);1<d&&(d-=1);return d<1/6?b+6*(a-b)*d:0.5>d?a:d<2/3?b+(a-b)*(2/3-d)*6:b}var d=0.5>a?2*a:a+1-1*a,g=2*a-d;return{U:Math.round(255*c(g,d,b+1/3)),Q:Math.round(255*c(g,d,b)),O:Math.round(255*c(g,d,b-1/3)),N:255}}function q(){for(var b=0;400>b;b++){var a=0-400/(b-400);I[b]=r(1-a,a/2)}}function D(){for(var b=0;b<c;b++)for(var a=0;a<f;a++)u[b][a].c&&(v.beginPath(),v.rect(b*w,a*w,w,w),v.fill(),v.closePath())}var y={},m=a.F,h=a.V,s=a.T,
e=a.P,B,z,k,v,w=a.K,u=a.v,C=a.p,c=a.l,f=a.k,d=m.width,g=m.height,b,n,l,I=[];m.getContext?(a.G=m.getContext("2d"),a.C=h.getContext("2d"),a.w=s.getContext("2d"),a.D=e.getContext("2d"),B=a.G,z=a.C,k=a.w,v=a.D,z.strokeStyle="red",z.fillStyle="red",k.strokeStyle="black",k.fillStyle="black",v.fillStyle="yellow",b=B.createImageData(d,g),n=b.data,l=b.width,q()):console.log("This browser does not support canvas");y.t=function(){var e=a.o;a.j&&z.clearRect(0,0,d,g);if(0<C.length){k.clearRect(0,0,d,g);for(var p=
0,h=C.length;p<h;p++){var t=C[p].x,x=C[p].y;k.beginPath();k.arc(t*w,x*w,1,0,2*Math.PI,!1);k.fill();k.closePath()}}a.q&&(v.clearRect(0,0,d,g),D(),a.q=!1);for(p=0;p<c;p++)for(h=0;h<f;h++)if(!u[p][h].c){var t={r:0,g:0,b:0,a:0},t=0,x=u[p][h].h,m=u[p][h].i;if(a.j&&0===p%10&&0===h%10){var s=x,y=m,q=p*w,r=h*w;z.beginPath();z.moveTo(q,r);z.lineTo(Math.round(q+s*w*200),r+y*w*200);z.stroke();z.beginPath();z.arc(q,r,1,0,2*Math.PI,!1);z.fill();z.closePath()}if(0===e)t=parseInt(400*(Math.sqrt(Math.pow(x,2)+Math.pow(m,
2))+0.21));else if(1==e)t=parseInt(400*(x+0.21052631578));else if(2==e)t=parseInt(400*(m+0.21052631578));else if(3==e)t=parseInt(400*(u[p][h].n-0.75));else if(4==e)t=parseInt(400*(u[p][h].H+0.25196850393));else if(5==e)continue;400<=t?t=399:0>t&&(t=0);t=I[t];for(x=h*w;x<(h+1)*w;x++)for(m=p*w;m<(p+1)*w;m++)s=4*(m+x*l),n[s+0]=t.U,n[s+1]=t.Q,n[s+2]=t.O,n[s+3]=t.N}B.putImageData(b,0,0)};y.clear=function(){b=B.createImageData(d,g);n=b.data;l=b.width;z.clearRect(0,0,d,g);k.clearRect(0,0,d,g);B.clearRect(0,
0,d,g);v.clearRect(0,0,d,g);D();a.q=!1};return y}();return a}(A);A=A||{};
A=function(a){a.W=function(){function r(u){if(1===(u.which||u.button)&&a.e){var C=u.hasOwnProperty("offsetX")?u.offsetX:u.layerX,c=u.hasOwnProperty("offsetY")?u.offsetY:u.layerY,f=function(a){var b=a.hasOwnProperty("offsetX")?a.offsetX:a.layerX;a=a.hasOwnProperty("offsetY")?a.offsetY:a.layerY;var d=(b-C)/h/B,f=(a-c)/h/B;0.1<Math.abs(d)&&(d=0.1*Math.abs(d)/d);0.1<Math.abs(f)&&(f=0.1*Math.abs(f)/f);for(var e=Math.floor(b/h),u=Math.floor(a/h),p=-5;5>=p;p++)for(var k=-5;5>=k;k++)0<=e+p&&e+p<D&&0<=u+k&&
u+k<y&&!m[e+p][u+k].c&&5>Math.sqrt(p*p+k*k)&&s.push([e+p,u+k,d,f]);C=b;c=a},d=function(){e.removeEventListener("mousemove",f,!1);e.removeEventListener("mouseup",d,!1);e.removeEventListener("touchmove",f,!1);document.body.removeEventListener("touchend",d,!1)};e.addEventListener("mousemove",f,!1);e.addEventListener("mouseup",d,!1);e.addEventListener("touchmove",f,!1);document.body.addEventListener("touchend",d,!1)}}function q(e){window.cancelAnimationFrame(a.e);a.e=null;e.innerHTML="Start"}var D=a.l,
y=a.k,m=a.v,h=a.K,s=a.A,e=a.F,B=a.B,z=a.p,k,v,w;e.addEventListener("mousedown",r,!1);e.addEventListener("touchstart",r,!1);e.addEventListener("contextmenu",function(k){function C(){e.removeEventListener("mousemove",c,!1);e.removeEventListener("mouseup",C,!1);e.removeEventListener("touchmove",c,!1);document.body.removeEventListener("touchend",C,!1)}function c(c){f=c.hasOwnProperty("offsetX")?c.offsetX:c.layerX;d=c.hasOwnProperty("offsetY")?c.offsetY:c.layerY;g=Math.floor(f/h);b=Math.floor(d/h);m[g][b].c=
n;a.q=!0;a.e||a.f.t()}k.preventDefault();var f=k.hasOwnProperty("offsetX")?k.offsetX:k.layerX,d=k.hasOwnProperty("offsetY")?k.offsetY:k.layerY,g=Math.floor(f/h),b=Math.floor(d/h),n=!0;m[g][b].c&&(n=!1);m[g][b].c=n;e.addEventListener("mousemove",c,!1);e.addEventListener("mouseup",C,!1);e.addEventListener("touchmove",c,!1);document.body.addEventListener("touchend",C,!1)},!1);document.getElementById("drawmode").addEventListener("change",function(){a.o=this.selectedIndex;5==a.o&&a.f.clear()},!1);document.getElementById("viscosity").addEventListener("input",
function(){a.M=parseInt(this.value,10)/100;a.J=1/(3*a.M+0.5)},!1);document.getElementById("speed").addEventListener("input",function(){a.B=parseInt(this.value,10)},!1);v=document.getElementById("flowvectors");v.addEventListener("click",function(){this.checked?a.j=!0:(a.j=!1,a.C.clearRect(0,0,e.width,e.height))},!1);w=document.getElementById("flowparticles");w.addEventListener("click",function(){this.checked?a.m.S():(z.length=0,a.w.clearRect(0,0,e.width,e.height))},!1);k=document.getElementById("play");
k.addEventListener("click",function(){a.e?q(this):(a.A.length=0,a.m.L(),this.innerHTML="Pause")},!1);document.getElementById("reset").addEventListener("click",function(){q(k);a.j=!1;a.p.length=0;v.checked=!1;w.checked=!1;a.m.I();a.f.clear()},!1);document.getElementById("clearbarriers").addEventListener("click",function(){a.m.R([]);a.f.clear()},!1);document.getElementById("flow-speed").addEventListener("input",function(){a.u=parseInt(this.value,10)/833},!1)}();return a}(A);A=A||{};
A=function(a){a.m=function(){function r(){this.d=[0,0,0,0,0,0,0,0,0];this.s=[0,0,0,0,0,0,0,0,0];this.i=this.h=this.n=0;this.c=!1;this.H=0}function q(a){if(void 0!==a){for(var c=0;c<h;c++)for(var f=0;f<s;f++)e[c][f].c=!1;for(c=0;c<a.length;c++)e[a[c].x][a[c].y].c=!0}else for(c=0;c<h;c++)for(f=0;f<s;f++)if(0===c||c===h-1||0===f||f===s-1||10>Math.abs(h/2-c)&&10>Math.abs(s/2-f))e[c][f].c=!0}function D(a,c,e){var d=[],g=3*a,b=3*-c,h=a*a,l=-c*-c;a=2*a*-c;c=h+l;var m=1.5*c;d[0]=z*e*(1-m);d[1]=k*e*(1+g+4.5*
h-m);d[2]=k*e*(1+b+4.5*l-m);d[3]=k*e*(1-g+4.5*h-m);d[4]=k*e*(1-b+4.5*l-m);d[5]=v*e*(1+g+b+4.5*(c+a)-m);d[6]=v*e*(1-g+b+4.5*(c-a)-m);d[7]=v*e*(1-g-b+4.5*(c+a)-m);d[8]=v*e*(1+g-b+4.5*(c-a)-m);return d}var y={},m=a.A,h=a.l,s=a.k,e=a.v,B=a.p,z=4/9,k=1/9,v=1/36,w={0:{x:0,y:0},1:{x:1,y:0},2:{x:0,y:-1},3:{x:-1,y:0},4:{x:0,y:1},5:{x:1,y:-1},6:{x:-1,y:-1},7:{x:-1,y:1},8:{x:1,y:1}},u={0:0,1:3,2:4,3:1,4:2,5:7,6:8,7:5,8:6};y.L=function(){var C=a.B,c,f=a.u;for(c=0;c<h-1;c++)e[c][0].d=D(f,0,1),e[c][s-1].d=D(f,
0,1);for(c=0;c<s-1;c++)e[0][c].d=D(f,0,1),e[h-1][c].d=D(f,0,1);for(f=0;f<C;f++){for(c=0;c<h;c++)for(var d=0;d<s;d++){var g=e[c][d];if(!g.c)for(var b=0;9>b;b++){var n=w[b],l=n.x+c,n=n.y+d;0<=l&&l<h&&0<=n&&n<s&&(e[l][n].c?e[c][d].s[u[b]]=g.d[b]:e[l][n].s[b]=g.d[b])}}c=a.J;for(d=1;d<h-1;d++)for(g=1;g<s-1;g++)if(n=e[d][g],!n.c){b=n.d;for(l=0;9>l;l++)b[l]=n.s[l];var l=b[0]+b[1]+b[2]+b[3]+b[4]+b[5]+b[6]+b[7]+b[8],q=(b[1]+b[5]+b[8]-b[3]-b[6]-b[7])/l,r=(b[4]+b[7]+b[8]-b[2]-b[5]-b[6])/l;n.n=l;n.h=q;n.i=r;
4==a.o&&0<d&&d<h-1&&0<g&&g<s-1&&(n.H=e[d+1][g].i-e[d-1][g].i-e[d][g+1].h+e[d][g-1].h);var n=3*q,p=3*r,E=q*q,t=r*r,q=2*q*r,r=E+t,x=1.5*r;b[0]+=c*(z*l*(1-x)-b[0]);b[1]+=c*(k*l*(1+n+4.5*E-x)-b[1]);b[2]+=c*(k*l*(1-p+4.5*t-x)-b[2]);b[3]+=c*(k*l*(1-n+4.5*E-x)-b[3]);b[4]+=c*(k*l*(1+p+4.5*t-x)-b[4]);b[5]+=c*(v*l*(1+n-p+4.5*(r-q)-x)-b[5]);b[6]+=c*(v*l*(1-n-p+4.5*(r+q)-x)-b[6]);b[7]+=c*(v*l*(1-n+p+4.5*(r-q)-x)-b[7]);b[8]+=c*(v*l*(1+n+p+4.5*(r+q)-x)-b[8])}if(0<B.length)for(c=0,d=B.length;c<d;c++)g=B[c],b=Math.floor(g.x),
l=Math.floor(g.y),0<=b&&b<h&&0<=l&&l<s&&(b=e[b][l],l=b.i,g.x+=b.h,g.y+=l),0<a.u&&g.x>h-2&&(g.x=1);for(;0<m.length;)c=m.shift(),d=e[c[0]][c[1]],d.d=D(c[2],c[3],d.n)}a.f.t();a.e=requestAnimationFrame(y.L)};y.I=function(){for(var k=h,c=s,f=e.length=0;f<k;f++){e[f]=[];for(var d=0;d<c;d++)e[f][d]=new r}q([]);for(k=0;k<h;k++)for(c=0;c<s;c++)f=e[k][c],f.c||(f.n=1,f.h=0,f.i=0,d=D(0,0,1),f.d=d.slice(0),f.s=d.slice(0));m.length=0;a.f.t()};y.R=q;y.S=function(){B.length=0;for(var a=1;20>a;a++)for(var c=1;8>c;c++)e[10*
a][10*c].c||B.push({x:10*a,y:10*c})};return y}();return a}(A);A.m.I();
