Y=600;Z=99;
function h(e,f,g){k=[];for(D=0;9>D;D++)G=m[2*D]*e+m[2*D+1]*f,n=D?5>D?1/9:1/36:4/9,k[D]=n*g*(1+3*G+4.5*G*G-1.5*(e*e+f*f))}with(Math)S=sqrt,P=pow,F=floor;g=[],k=[],p=1,m=[0,0,1,0,0,-1,-1,0,0,1,1,-1,-1,-1,-1,1,1,1];I=c.createImageData(Y,Y);a.onmousemove=function(e){for(M=-16;17>M;M++)J=g[F(e.layerX/6+M/5)][F(e.layerY/6)+M%5],h(.1,.1,J.c),J.a=k};(function q(){L=I.data;for(l=0;Z*Z>l;l++){f=F(l/Z);e=l%Z;p&&(0==f&&(g[e]=[]),g[e][f]={b:[],a:[],c:1,x:0,y:0},h(0,0,1),g[e][f].a=
k);M=g[e][f];C=M.a;T=C[1]+C[5]+C[8];U=C[3]+C[6]+C[7];W=T+U+C[0]+C[2]+C[4];M.x=(T-U)/W;M.y=(C[4]+C[7]+C[8]-C[2]-C[5]-C[6])/W;M.c=W;h(M.x,M.y,W);for(i=0;9>i;i++)M.b[i]=C[i]+1*(k[i]-C[i]);for(i=0;36>i;i++)V=4*(i%6+6*e+Y*(F(i/6)+6*f)),L[V+1]=Z*Z,L[V+3]=F(4E3*S(P(g[e][f].x,2)+P(g[e][f].y,2)))}c.putImageData(I,0,0);for(Q=p=0;Z*Z>Q;Q++)for(f=F(Q/Z),e=Q%Z,K=0;9>K;K++)N=m[2*K]+e,R=m[2*K+1]+f,0<=N&&Z>N&&0<=R&&Z>R&&(g[N][R].a[K]=g[e][f].b[K]);setTimeout(q)})()