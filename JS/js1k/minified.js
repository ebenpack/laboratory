X='slice'
function t(h,f,k){n=[];for(var e=0;9>e;e++){var g=r[X](4*e,4*e+2)*h+r[X](4*e+2,4*e+4)*f;p=e?5>e?1/9:1/36:4/9;n[e]=p*k*(1+3*g+4.5*g*g-1.5*(h*h+f*f))}}with(Math)S=sqrt,P=pow,F=floor;var Y=100,W=600,Z='width',m=[],k,h,f,n=[],u=1,p,r=" 0 0 1 0 0-1-1 0 0 1 1-1-1-1-1 1 1 1";a[Z]=a.height=W;a.onmousemove=function(h){for(var f=-16;17>f;f++){var k=m[F(h.layerX/6+f/5)][F(h.layerY/6)+f%5];t(0.1,0.1,k.n);k.s=n}};(function v(){var q=c.createImageData(W,W),e=q.data;for(k=0;1E4>k;k++){f=F(k/Y);h=k%Y;u&&
(0==f&&(m[h]=[]),m[h][f]={d:[],s:[],n:1,x:0,y:0},t(0,0,1),m[h][f].s=n);var g=m[h][f],d=g.d,d=g.s[X](0),l=d[1]+d[5]+d[8],p=d[3]+d[6]+d[7],s=l+p+d[0]+d[2]+d[4];g.x=(l-p)/s;g.y=(d[4]+d[7]+d[8]-d[2]-d[5]-d[6])/s;g.n=s;t(g.x,g.y,s);for(l=0;9>l;l++)g.d[l]=d[l]+1.7*(n[l]-d[l]);for(g=6*f;g<6*(f+1);g++)for(d=6*h;d<6*(h+1);d++)l=4*(d+W*g),e[l+1]=255,e[l+3]=F(4E3*S(P(m[h][f].x,2)+P(m[h][f].y,2)))}c.putImageData(q,0,0);for(k=u=0;1E4>k;k++)for(f=F(k/Y),h=k%Y,q=m[h][f],e=0;9>e;e++)g=1*r[X](4*e,4*e+
2)+h,d=1*r[X](4*e+2,4*e+4)+f,0<=g&&Y>g&&0<=d&&Y>d&&(m[g][d].s[e]=q.d[e]);setTimeout(v)})()